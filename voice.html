<html>
    <body>
        <h2><p>Dutch Text Reader by Sriram Yeluri</p></h2> 

        <select name="language" id="voiceselection"> 
            <option sected value="Dutch Male">Dutch Male</option> 
            <option value="Dutch Female">Dutch Female</option>       
        </select>
        <script src="https://code.responsivevoice.org/responsivevoice.js"></script>
        <script src="https://code.jquery.com/jquery-2.1.4.min.js"></script>        
        <textarea autofocus id="text" cols="80" rows="15" style="font-size: 14pt">wat lees u graag</textarea>
        <br>
        <button onclick="responsiveVoice.speak(getSelectionText(),$('#voiceselection').val(),{rate: 0.8}); " 
            type="button" value="Play">Play</button>
        <script>
            function getSelectionText() { 
                var text = "";
                if (window.getSelection) { 
                    text = window.getSelection().toString(); 
                // for Internet Explorer 8 and below. For Blogger, you should use &amp;&amp; instead of &&. 
                    } else if (document.selection && document.selection.type != "Control") { 
                        text = document.selection.createRange().text;
                        }
                        return text; 
                }
                
                $(document).ready(function (){ // when the document has completed loading 
                    $(document).mouseup(function (e){ // attach the mouseup event for all div and pre tags 
                        setTimeout(function() { // When clicking on a highlighted area, the value stays highlighted until after the mouseup event, and would therefore stil be captured by getSelection. This micro-timeout solves the issue.  
                        responsiveVoice.cancel(); // stop anything currently being spoken 
                        responsiveVoice.speak(getSelectionText(),$('#voiceselection').val(),{rate: 0.8}); //speak the text as returned by getSelectionText 
                        }, 1); 
                    }); 
                }); 

        </script>
        <script src="https://code.responsivevoice.org/responsivevoice.js?key=c5Qjxrbh"></script>
    </body>
</html>